#!/bin/bash

#Function for the System Admin Menu
sysAdmin(){
	#Makes the gui for the System Admin menu
	yad --title="System Admin Menu" --form --width=250 --text="Pick and option:" \
        --field="List all running processes":fbtn "2" \
        - field="List all running services":fbtn "3" \
        --field="List all installed software":fbtn "4" \
        --field="List all users":fbtn "5" \
        --field="Return to main menu":fbtn "6" \
        --button=gtk-cancel:1
	selection=$?
	
	#Case statement to figure out which option the user picked
	case "$selection" in
		#Lists all running processes
		"1") yad --text="$(ps -aux)";;
		#Lists all running services
		"2") yad --text="$(service --status-all | grep +)";;
		#Lists all installed software
		"3") yad --text="$(dpkg -l)";;
		#Lists all users
		"4") yad --text="$(awk -F':' '{print $1",",$3",",$4",",$6",",$7}' /etc/passwd)";;
		#Returns user to the main menu
		"5") clear; mainMenu;;
		#Exits the program
		"6") exit;;
		*);;
	esac
}
#Function for the Security Admin Menu
secAdmin(){
	#Makes the gui for the Security Admin Menu
        yad --title="Security Admin Menu" --form --width=250 --text="Pick an option" \
        --field="List last 10 logged in users":fbtn "2" \
        - field="Print the last 20 lines of an arbitrary file in the /var/log/ directory":fbtn "3" \
        --field="Run the command: netstat -apn --inet":fbtn "4" \
        --field="Use lsof to print the details of a specific process or process ID provided by the user":fbtn "5" \
        --field="Return to main menu":fbtn "6" \
        --button=gtk-cancel:1
	selection=$?
	#Case statement to figure out which option the user picked
	case "$selection" in
		#Lists last 10 logged in users
		"1") yad --text="$(last -n 10)";;
		#Prints the last 20 lines of a user difined file
		"2")
			logFiles=$(ls -p /var/log/ | grep -v /)
			yad --text="$logFiles"
			file='yad --text="Enter the name of the file" --entry'
			logfile=$(head -10 /var/log/$file)
			yad --text="$logfile";;
		#Runs the command netstat -apn --inet
		"3") yad --text="$(netstat -apn --inet)";;
		#Uses lsof to print the details of a specific process or process ID provided by the user
		"4")
			yad --text="$(ps -aux)"
			pid='yad --text="Enter of the PID of the process" --entry'
			yad --text="$(lsof -p $pid)";;
		#Returns user to the main menu
		"5") mainMenu;;
		#exits the program
		"6") exit;;
		*);;
	esac
}
#Function for Main Menu 
mainMenu(){
	#Makes the gui for the Main Menu
        yad --Title="Main Menu" --text="Select an option:"\
        --button="System Admin":1\
        --button="Security Admin":2\
        --button="Exit":3
	#this variable captures what button the user clicks
	options=$?
	#A case statement to send the user to where they selected
        case "$options" in
		#Sends the user to the System Admin Menu
		"1") sysAdmin;;
		#Sends the user to the Security Admin Menu
		"2") secAdmin;;
		#Exits the program
		"3") exit;;
		*);;
        esac
}
msinMenu
